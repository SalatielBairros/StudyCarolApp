WITH hlpartnumberslot_uniquehlpartnumberslot AS (
  select trim(partnumberid) as partnumberid, slotid      
    from stg_hlcloud_hlpartnumberslot
    qualify ROW_NUMBER() OVER (PARTITION BY partnumberid, slotid ORDER BY mdmCounterForEntity DESC, mdmLastUpdated DESC) = 1  
),
combinedSources AS (
  SELECT * FROM hlpartnumberslot_uniquehlpartnumberslot
),
processedData AS (
  SELECT *
  FROM combinedSources
)

SELECT * FROM processedData

